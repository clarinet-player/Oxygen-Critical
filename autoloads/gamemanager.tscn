[gd_scene load_steps=2 format=3 uid="uid://rkpec2pimdms"]

[sub_resource type="GDScript" id="GDScript_l67j1"]
script/source = "extends Node

var local_player : Node3D



func get_new_id():
	var id := 1
	
	while get_node_or_null(str(id)):
		id = randi_range(1, 9223372036854775807)
	
	return id



func spawn_player(id : int, authority : int, data : Array):
	
	var player = preload(\"res://classes/player.tscn\").instantiate()
	player.name = str(id)
	player.set_multiplayer_authority(authority)
	
	add_child(player)
	player.update(data)
	
	if authority == multiplayer.get_unique_id():
		local_player = player
		UiManager.set_active_ui(3)



func spawn_bullet(playerid : int, id : int, data : Array):
	var _bullet = preload(\"res://classes/bullet.tscn\").instantiate()
	
	_bullet.name = str(id)
	_bullet.set_multiplayer_authority(1)
	
	add_child(_bullet, true)
	_bullet.update(data)
	if get_object(playerid):
		get_object(playerid).weapon.play_sound()



func destroy_object(id : int):
	var node = get_node_or_null(str(id))
	if node:
		node.queue_free()
		if node == local_player:
			local_player = null
			UiManager.set_active_ui(0)



func id_from_auth(auth : int) -> int:
	for child in get_children():
		if \"authority\" in child and child.authority == auth:
			return int(str(child.name))
	
	return 0



func clear():
	for child in get_children():
		child.queue_free()
		remove_child(child)
	local_player = null



func get_object(id : int):
	return get_node_or_null(str(id))


"

[node name="GameManager" type="Node"]
script = SubResource("GDScript_l67j1")
